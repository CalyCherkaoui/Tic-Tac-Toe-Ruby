#!/usr/bin/env ruby
require './lib/player.rb'
require './lib/board.rb'
require './lib/validation.rb'
include Validation
puts '*********************************************'
puts ''
puts '******* Welcome to Tic Tac Toe game *********'
puts ''
puts '*********************************************'
puts 'player 1: Please enter your name'
player1_name = gets.chomp.capitalize
# create player1 orbject
player1 = Player.new(player1_name, [])
puts ''
puts "#{player1_name} your totem is O"
puts ''
puts 'player 2: Please enter your name'
puts ''
player2_name = gets.chomp.capitalize
# create player1 orbject
player2 = Player.new(player2_name, [])
puts ''
puts "#{player2_name} your totem is X"
puts ''
# Game initialization
board0= Board.new
grid_array = board0.get_board_grid
# Display new Board
puts "#{grid_array[0]} | #{grid_array[1]} | #{grid_array[2]}
---------
#{grid_array[3]} | #{grid_array[4]} | #{grid_array[5]}
---------
#{grid_array[6]} | #{grid_array[7]} | #{grid_array[8]}"
puts ''

until player1.winner? || player2.winner? || board0.grid_filled? do 

puts "#{player1_name} Pick an avalible number"
pick = gets.chomp.to_i

until (Validation.pick_valid?(pick) && Validation.not_picked?(pick , grid_array)) do
  if !Validation.pick_valid?(pick)
    puts 'Your pick is not valid ! pick a number from 1 to 9'
    pick = gets.chomp.to_i
  elsif !Validation.not_picked?(pick , grid_array)
    puts 'Number already picked, Try again'
    pick = gets.chomp.to_i
  end
end

# validate the pick
player1.picks_array << pick
puts ''
board1 = Board.new(pick , "O")
grid_array = board1.update_grid
#display
puts "#{grid_array[0]} | #{grid_array[1]} | #{grid_array[2]}
---------
#{grid_array[3]} | #{grid_array[4]} | #{grid_array[5]}
---------
#{grid_array[6]} | #{grid_array[7]} | #{grid_array[8]}"
puts ''

puts "#{player2_name} Pick an avalible number"
pick = gets.chomp.to_i
until (Validation.pick_valid?(pick) && Validation.not_picked?(pick , grid_array)) do
  if !Validation.pick_valid?(pick)
    puts 'Your pick is not valid ! pick a number from 1 to 9'
    pick = gets.chomp.to_i
  elsif !Validation.not_picked?(pick , grid_array)
    puts 'Number already picked, Try again'
    pick = gets.chomp.to_i
  end
end

player2.picks_array << pick

board2 = Board.new(pick , "X")
grid_array = board2.update_grid
#display
puts "#{grid_array[0]} | #{grid_array[1]} | #{grid_array[2]}
---------
#{grid_array[3]} | #{grid_array[4]} | #{grid_array[5]}
---------
#{grid_array[6]} | #{grid_array[7]} | #{grid_array[8]}"
puts ''

#  ---- iterate till the end of the game----
# puts the name of the winner or if the game is draw ('old lady')
end  